:docname: gs-install
:page-module: java
:page-relative-src-path: gs-install.adoc
:page-origin-url: https://github.com/couchbase/docs-couchbase-lite.git
:page-origin-start-path:
:page-origin-refname: antora-assembler-simplification
:page-origin-reftype: branch
:page-origin-refhash: (worktree)
[#java:gs-install:::]
=== Install
:page-aliases: start/java-gs-install.adoc
:page-role:
:page-toclevels: 2@
:description: Couchbase Lite on Java -- a framework for developing offline-first Java applications for mobile and edge
:keywords: mobile edge nosql api Java JVM web-app device-app




// BEGIN -- _define_module_attributes.adoc -- Java
//
// Definition:
//    Objective: This adoc defines values for attributes specific to pages within this module (Java)
//    Invoked-by: ROOT:_partials/_std_cbl_hdr.adoc (from within module/_partials/_set_page_context_for_java.adoc)
//    Parameters: none
// End Definition:


// BEGIN -- module page attributes
// Begin workaround for 2.8.1 mis-release, to avoid unnecessary install of 2.8.0
// SET full maintenance version number

// VECTOR SEARCH attributes

// End workaround
// :snippet-p2psync-ws: {snippets-p2psync-ws--java}
// END -- module page attributes


// BEGIN -- Define API References for this module
//  These attributes s
//:url-api-references-structs: https://docs.couchbase.com/mobile/{major}.{minor}.{maintenance-java}{empty}/couchbase-lite-java/Structs
// :url-api-references-classes: https://docs.couchbase.com/mobile/{major}.{minor}.{maintenance-java}{empty}/couchbase-lite-java/Classes




// Supporting Data Type Classes



// DatabaseConfiguration


//Database.SAVE



//Database.DELETE()




// deprecated 2.8
//
// :url-api-method-database-compact: https://docs.couchbase.com/mobile/{major}.{minor}.{maintenance-java}{empty}/couchbase-lite-java/com/couchbase/lite/Database.html#compact--[Database.compact()]
// was copy-java.io.File-java.lang.String-com.couchbase.lite.DatabaseConfiguration-[Database.copy()]





// links for documents pages


// :url-api-class-dictionary: https://docs.couchbase.com/mobile/{major}.{minor}.{maintenance-java}{empty}/couchbase-lite-java/com/couchbase/lite/Dictionary.html[property accessors]

// QUERY RELATED CLASSES and METHODS

// Result Classes and Methods




// Query class and methods

// Expression class and methods


// ArrayFunction class and methods
// https://docs.couchbase.com/mobile/2.8.0/couchbase-lite-java/com/couchbase/lite/ArrayFunction.html


// Function class and methods
//

// Where class and methods
//

// orderby class and methods
//

// GroupBy class and methods
//

// Endpoints








// https://ibsoln.github.io/betasites/api/mobile/2.8.0/couchbase-lite-java/com/couchbase/lite/URLEndpointListenerConfiguration.html#setPort-int-







// diag: Env+Module java




// Authenticators




// Replicator API










//:url-api-property-replicator-status-activity: https://docs.couchbase.com/mobile/{major}.{minor}.{maintenance-java}{empty}/couchbase-lite-java/com/couchbase/lite/Replicator.html#s:18CouchbaseLiteandroid10ReplicatorC13ActivityLevelO


// ReplicatorStatus



// ReplicatorConfiguration API












// replaced
// replaced
// replaces ^^



// Begin Replicator Retry Config
// End Replicator Retry Config










// Meta API


// END -- Define API References for this module

// diag: Env+Module java



// BEGIN Logs and logging references
// :url-api-class-logging: https://docs.couchbase.com/mobile/{major}.{minor}.{maintenance-java}{empty}/couchbase-lite-java/Logging.html[Logging classes]






// END  Logs and logging references







// END -- _define_module_attributes.adoc -- Java

// BEGIN::module page attributes
// :snippet-p2psync-ws: {snippets-p2psync-ws--java}

// END::Local page attributes

// DO NOT EDIT
[abstract]
--
Description -- _{description}_ +
_Abstract -- This content provides instructions that enable you to deploy Couchbase Lite on java_ +
Related Content -- xref:java:gs-install.adoc[Install] | xref:java:gs-prereqs.adoc[Prerequisites] | xref:java:gs-build.adoc[Build and Run]
--
// include::ROOT:partial$block-related-get-started.adoc[]
// DO NOT EDIT



[discrete#java:gs-install:::introduction]
==== Introduction


pass:q,a[_pass:q,a[pass:q,a[Couchbase{nbsp}Lite]]_] on Java {major}.{minor}.{base}{empty} enables development and deployment of pass:q,a[Couchbase{nbsp}Lite] applications to a JVM environment.
You can deploy Standalone (Java Desktop/Console) apps or Web Apps (using, for example, Tomcat; including embedded Tomcat deployments).


.Quick Steps
****
For experienced developers, this is all you need to add _pass:q,a[Couchbase{nbsp}Lite] for Java {major}.{minor}.{base}{empty}_ to your application projects.

[{tabs}]
=====
[#java:gs-install:::tabs-1-enterprise-edition]
Enterprise Edition::
+
--
Include the following in your Gradle `build.gradle` or Maven `pom.xml` file, as appropriate:

* The Couchbase Enterprise Edition repository +
`https://mobile.maven.couchbase.com/maven2/dev/`

* The pass:q,a[Couchbase{nbsp}Lite] Enterprise Edition dependency: +
`couchbase-lite-java-ee:{major}.{minor}.{base}{empty}`

. If you want to use Vector Search, add the Couchbase Lite Vector Search dependency: `couchbase-lite-java-vector-search`
. You must then use `CouchbaseLite.enableVectorSearch();` to enable the vector search extension.
--

[#java:gs-install:::tabs-1-community-edition]
Community Edition::
+
--
. Include the pass:q,a[Couchbase{nbsp}Lite] for Java dependency in your Gradle `build.gradle` or Maven `pom.xml` file, as appropriate: +
`couchbase-lite-java:{major}.{minor}.{base}{empty}`
. For Gradle: +
Check you have `mavenCentral()` in `repositories` (or in `settings.gradle`). +
Maven automatically checks its own repo for dependencies.
--
=====

NOTE: for Linux, make sure you have followed the <<java:gs-prereqs:::additional-steps-for-linux,additional steps required>>.

****
That's it!
You're all set to begin developing powerful pass:q,a[Couchbase{nbsp}Lite] applications.

Now, try the <<java:gs-build:::,Getting Started>> application, which demonstrates use of key CRUD functionality.



[discrete#java:gs-install:::preparing-your-build-environment]
==== Preparing Your Build Environment


This section shows how to set up and use pass:q,a[pass:q,a[_pass:q,a[pass:q,a[Couchbase{nbsp}Lite]]_]] on Java to build desktop and web applications using gradle, Maven, Tomcat and Intellij IDEA Community Edition.
It assumes a familiarity with these products, however you are free to use your own choice of development tools.

[discrete#java:gs-install:::binaries]
===== Binaries

pass:q,a[pass:q,a[_pass:q,a[pass:q,a[Couchbase{nbsp}Lite]]_]] on Java binaries are available for both Community (CE) and Enterprise (EE) editions from the _Maven_ repositories.

[discrete#java:gs-install:::prerequisites]
===== Prerequisites

* Planning to sync with a pass:q,a[_Couchbase{nbsp}Server_]?
+
You will need to have runnable instances of pass:q,a[_Couchbase{nbsp}Server_] and pass:q,a[pass:q,a[_pass:q,a[Sync{nbsp}Gateway]_]] installed.
If you have not already done so see xref:sync-gateway::get-started-prepare.adoc[Prepare Sync Gateway]
* Running on Microsoft Windows?
+
Windows requires {Cpp} runtime installed.
Please install the Visual {Cpp} Redistribution package from this link:
https://www.microsoft.com/en-us/download/details.aspx?id=52685

* Deploying to Linux? +
You need to deploy the pass:q,a[Couchbase{nbsp}Lite] `support` library, which is available _only_ on the zip download distributable.
See the _Additional Steps for Linux_ section in <<java:gs-prereqs:::additional-steps-for-linux>>.


[discrete#java:gs-install:::standalone-apps]
==== Standalone Apps

[IMPORTANT]
--
To use Vector Search, you must have Couchbase Lite installed and add the Vector Search extension to your Couchbase Lite application.
Vector Search is available only for 64-bit architectures and
Intel processors that support the Advanced Vector Extensions 2 (AVX2) instruction set.
To verify whether your device supports the AVX2 instructions set, https://www.intel.com/content/www/us/en/support/articles/000090473/processors/intel-core-processors.html[follow these instructions.]
--

[discrete#java:gs-install:::using-gradle]
===== Using Gradle

. Create a project folder
. Initialize it for a Gradle Java application
. Include the content shown in <<java:gs-install:::ex-bgf1>> in your app-level `build.gradle` file
. Open the project folder in Intellij IDEA and import the gradle settings.
+
--
TIP: If you don't have auto-import set for Gradle projects, then accept the *Import Gradle Project* prompt that is displayed bottom-right of the screen +
Note the Gradle menu at the extreme right of the screen:

image::couchbase-lite/current/java/_images/GradleMenuWebApp.png[,300]
--

That's it.
You're all set to start building your own pass:q,a[pass:q,a[_pass:q,a[pass:q,a[Couchbase{nbsp}Lite]]_]] on Java applications -- see xref:java:gs-build.adoc[Build and Run] for an example of how to do that.

.build.gradle file content
[#java:gs-install:::ex-bgf1]
====
[{tabs}]
=====

[#java:gs-install:::tabs-2-enterprise-edition]
Enterprise Edition::
+
--
.Compile options
[source,groovy, subs="attributes+"]
----
// Required only if your project has some Kotlin source code
kotlinOptions { jvmTarget = '11' }

// Set minimum JVM level to ensure availability of, for example, lambda expressions
compileOptions {
    targetCompatibility JavaVersion.VERSION_11
    sourceCompatibility JavaVersion.VERSION_11

//   ... other section content as required by user
}

----

.Dependencies

[source,groovy, subs="attributes+"]
----
dependencies {
    implementation "com.couchbase.lite:couchbase-lite-java:{major}.{minor}.{base}{empty}"

//   ... other section content as required by user
}

----

.Repositories
[source,groovy, subs="attributes+"]
----
repositories {
    maven {url 'https://mobile.maven.couchbase.com/maven2/dev/'}

//   ... other section content as required by user
    }

----
--

[#java:gs-install:::tabs-2-vector-search-extension]
Vector Search Extension::
+
NOTE: Vector Search is an *Enterprise-only* feature.
+
--
.Compile options
[source,groovy, subs="attributes+"]
----
// Required only if your project has some Kotlin source code
kotlinOptions { jvmTarget = '11' }

// Set minimum JVM level to ensure availability of, for example, lambda expressions
compileOptions {
    targetCompatibility JavaVersion.VERSION_11
    sourceCompatibility JavaVersion.VERSION_11

//   ... other section content as required by user
}

----

.Dependencies

[source,groovy, subs="attributes+"]
----
dependencies {
    implementation "com.couchbase.lite:couchbase-lite-java:{major}.{minor}.{base}{empty}"

  // All standard 64-bit ARM architectures
  implementation 'com.couchbase.lite:couchbase-lite-java-vector-search-arm64-{vs-major}.{vs-minor}.{vs-maintenance-java}{empty}'

//   ... other section content as required by user
}

----

.Repositories
[source,groovy, subs="attributes+"]
----
repositories {
    maven {url 'https://mobile.maven.couchbase.com/maven2/dev/'}
    google()
    mavenCentral()

//   ... other section content as required by user
    }

----

.Activating the Extension
[source,java, subs="attributes+"]
----
        try { CouchbaseLite.enableVectorSearch(); }
        catch (CouchbaseLiteException e) {
            throw new IllegalStateException("Could not enable vector search", e);
        }
----
--

[#java:gs-install:::tabs-2-community-edition]
Community edition::
+
--
.Compile options
[source,groovy, subs="attributes+"]
----
// Required only if your project has some Kotlin source code
kotlinOptions { jvmTarget = '11' }

// Set minimum JVM level to ensure availability of, for example, lambda expressions
compileOptions {
    targetCompatibility JavaVersion.VERSION_11
    sourceCompatibility JavaVersion.VERSION_11

//   ... other section content as required by user
}

----

.Dependencies
[source,groovy, subs="attributes+"]
----
dependencies {
    implementation "com.couchbase.lite:couchbase-lite-java:{major}.{minor}.{base}{empty}"

//   ... other section content as required by user
}

----
--

=====
====

[discrete.include-in-to#java:gs-install:::using-mavenc]
===== Using Maven

. Include the content shown in <<java:gs-install:::ex-bmf1>> in your `pom.xml` file in the root of your project folder

. That's it -- just add your own code

You're all set to start building your own pass:q,a[pass:q,a[_pass:q,a[pass:q,a[Couchbase{nbsp}Lite]]_]] on Java applications -- see xref:java:gs-build.adoc[Build and Run] for an example of how to do that.

.pom.xml file content
[#java:gs-install:::ex-bmf1]
====
[{tabs}]
=====
[#java:gs-install:::tabs-3-enterprise-edition]
Enterprise Edition::
+
--
.Compile properties
[source, XML, subs="attributes+"]
----
<properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <maven.compiler.source>11</maven.compiler.source>
    <maven.compiler.target>11</maven.compiler.target>
</properties>

----

.Dependencies

[source, XML, subs="attributes+"]
----
<dependencies>

    <dependency>
      <groupId>com.couchbase.lite</groupId>
      <artifactId>couchbase-lite-java-ee</artifactId>
      <version>{major}.{minor}.{base}{empty}</version>
    </dependency>

    <!-- ... any other section content as required by user-home  -->
</dependencies>

----

.Repositories
[source,xml, subs="attributes+"]
----
<repositories>
  <repository>
    <id>couchbase</id>
    <url>https://mobile.maven.couchbase.com/maven2/dev/</url>
  </repository>
  //   ... any other section content as required by user

</repositories>

----
--

[#java:gs-install:::tabs-3-community-edition]
Community edition::
+
--
.Compile properties
[source, XML, subs="attributes+"]
----
<properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <maven.compiler.source>11</maven.compiler.source>
    <maven.compiler.target>11</maven.compiler.target>
</properties>

----

.Dependencies
[source, xml, subs="attributes+"]
----

<dependencies>
  <dependency>
      <groupId>com.couchbase.lite</groupId>
      <artifactId>couchbase-lite-java</artifactId>
      <version>{major}.{minor}.{base}{empty}</version>
  </dependency>

  //   ... any other section content as required by user
</dependencies>

----
--

=====
====


[discrete#java:gs-install:::web-app-development]
==== Web App Development


This section explains how to set-up a build project to create pass:q,a[pass:q,a[_pass:q,a[pass:q,a[Couchbase{nbsp}Lite]]_]] on Java web apps using gradle and Intellij IDEA.

.Using Maven
[TIP]
--
For examples of how to do this using Maven POM files, see --

* https://github.com/couchbaselabs/mobile-travel-sample/tree/master/java/TravelSample[Couchbase Mobile Workshop]

* https://github.com/couchbaselabs/mobile-training-todo/tree/release/lithium/java-ws/server/Todo[Mobile Training To Do App]
--


[discrete#java:gs-install:::tomcat]
===== Tomcat

In our examples here we build and deploy web apps using a gradle plugin based on the `com.bmuschko.tomcat` plugin.
It provides a simple Tomcat harness that can be used from within Intellij IDEA or the command-line -- see <<java:gs-install:::lbl-tomcat>>

[discrete#java:gs-install:::bmkMultCblJapps, Running multiple pass:q,a[pass:q,a[_pass:q,a[pass:q,a[Couchbase{nbsp}Lite]]_]] on Java web apps]
===== Multiple Web Apps

Each web application has its own *class loader (WebappX).
This loads the classes, jars, and resources found in the application's `WEB-INF/classes` and `WEB-INF/lib` folders, together with any shared jar files from `$CATALINA_BASE/lib` -- see https://tomcat.apache.org/tomcat-9.0-doc/class-loader-howto.html[tomcat documentation] for more.

So, if you are running multiple pass:q,a[Couchbase{nbsp}Lite] web applications, deploy your {cbljp} library `<pathToCbl>/libs` to `$CATALINA_BASE/lib`. This means you do not need to deploy it in each web app and *minimizes the size of each app*.

NOTE:  Configuring pass:q,a[Couchbase{nbsp}Lite] logging functionality will affect the logging of all web applications as the _common class loader_ shares _pass:q,a[Couchbase{nbsp}Lite] Console, File_ and _Custom logging functionalities_  across all  web apps.

For information about building a WAR file see <<java:gs-install:::lbl-war>>

[discrete#java:gs-install:::prerequisites-2]
===== Prerequisites

* Ensure your build environment matches the runtime Tomcat environment.
Specifically, that the Java and Tomcat versions are the same.
* If your Tomcat server runs Linux, declare the _shared libraries_ (`<pathToCbl>/support`) in the `$CATALINA_HOME/bin/setenv.sh` script file -- see: _Additional Steps for Linux_ section in xref:java:gs-prereqs.adoc[Prerequisites].
* Ensure the pass:q,a[Couchbase{nbsp}Lite] jars (`<pathToCbl>/lib`) are on the executable path within Tomcat -- see: <<java:gs-install:::bmkMultCblJapps>>
+

TIP: This also means you should declare the dependencies as `providedCompile` to avoid them being bundled into the `WEB-INF/libs` folder

[discrete#java:gs-install:::steps]
===== Steps

. Create a project folder and initialize it for a Gradle Java application
+
[source, bashrc]
----
gradle init
----

. Create your `build.gradle` file, including the <<java:gs-install:::ex-bgf2>> in your app-level build.gradle:

. Open the project folder in Intellij IDEA and import the gradle settings.

TIP: If you don't have auto-import set for Gradle projects, then accept the   *Import Gradle Project* prompt that is displayed bottom-right of the screen. +
Note the Gradle menu at the extreme right of the screen: +
image::GradleMenuWebApp.png[,300]

If you want to deploy your app to a local tomcat container then see <<Deploying a WAR file to tomcat>>

That's it.
You're all set to start building your own pass:q,a[pass:q,a[_pass:q,a[pass:q,a[Couchbase{nbsp}Lite]]_]] on Java applications -- see <<java:gs-build:::,Building a Getting Started App>> for an example of how to do that.

.build.gradle file content
[#java:gs-install:::ex-bgf2]
====
[{tabs}]
=====

[#java:gs-install:::tabs-4-community]
Community::
+
--

[source,groovy,subs=attributes+]
----
dependencies {
    implementation "com.couchbase.lite:couchbase-lite-java:{major}.{minor}.{base}{empty}"

//   ... other section content as required by user
}

----

--

[#java:gs-install:::tabs-4-enterprise]
Enterprise::
+
--
[source,groovy, subs="attributes+"]]

----
repositories {
    maven {url 'https://mobile.maven.couchbase.com/maven2/dev/'}

//   ... other section content as required by user
    }

dependencies {
    implementation "com.couchbase.lite:couchbase-lite-java-ee:{major}.{minor}.{base}{empty}"

//   ... other section content as required by user
    }

----
=====
====


[discrete#java:gs-install:::lbl-tomcat]
==== Embedded Tomcat

The simplest way to build and deploy your pass:q,a[pass:q,a[_pass:q,a[pass:q,a[Couchbase{nbsp}Lite]]_]] on Java web app is to use a gradle plugin that provides a simple Tomcat harness.

Our examples are based on the `com.bmuschko.tomcat` plugin -- see https://github.com/bmuschko/gradle-tomcat-plugin[com.bmuschko.tomcat on Github].

Including the plugin in your `build.gradle` file make a number of tomcat tasks available to you. View them using:

[source, bash]
----
./gradlew tasks
----

This shows that the following web application tasks are now available:

** `tomcatJasper` - Runs the JSP compiler and turns JSP pages into Java source.
** `tomcatRun` - Uses your files as and where they are and deploys them to Tomcat.
** `tomcatRunWar` - Assembles the web app into a war and deploys it to Tomcat.
** `tomcatStop` - Stops Tomcat.

So, to run the app use:

[source, bash]
----
./gradlew tomcatRun
----

[discrete#java:gs-install:::lbl-war]
==== Deploying a WAR File

To deploy your web app to a local Tomcat instance you need to generate a WAR file.
However, you should note that when creating a war file, if you use the `implementation` dependency type then your _pass:q,a[Couchbase{nbsp}Lite]_ jar files will be bundled into WEB-INF/lib of the web application.
To exclude pass:q,a[Couchbase{nbsp}Lite] jar files from getting bundled and to use pass:q,a[Couchbase{nbsp}Lite] in multiple web applications, change the dependency type from *`implementation`* to *`providedCompile`*

. You can do this using the Gradle command below from within your project folder:
[source, bashrc]
+
----
./gradlew war
----
+
NOTE:  The generated war file will be at <PROJECT ROOT>/build/libs.


. Deploy the war file to Tomcat, by copying it to $CATALINA_BASE/webapps
+
TIP: You can also use Tomcatâ€™s Manager App to deploy the war file -- see https://tomcat.apache.org/tomcat-9.0-doc/manager-howto.html[Tomcat's Manager App] documentation for more detail.

. To use common class loader approach to load pass:q,a[Couchbase{nbsp}Lite] libraries, copy all of the pass:q,a[Couchbase{nbsp}Lite] jar files in $CATALINA_BASE/lib.
+
NOTE: For linux platform see also -- _Using Native Libraries for Linux_ in xref:java:gs-prereqs.adoc[Prerequisites]



// :param-add3-title: {empty}
// :param-reference: reference-p2psync



[discrete#java:gs-install:::related-content]
==== Related Content
++++
<div class="card-row three-column-row">
++++

[.column]
===== {empty}
.How to . . .
* xref:java:gs-prereqs.adoc[Prerequisites]
* xref:java:gs-install.adoc[Install]
* xref:java:gs-build.adoc[Build and Run]


.

[discrete.colum#java:gs-install:::-2n]
===== {empty}
.Learn more . . .
* xref:java:database.adoc[Databases]
* xref:java:document.adoc[Documents]
* xref:java:blob.adoc[Blobs]
* xref:java:replication.adoc[Remote Sync Gateway]
* xref:java:conflict.adoc[Handling Data Conflicts]

.


[.column]
// [.content]
[discrete#java:gs-install:::-3]
===== {empty}
.Dive Deeper . . .
//* Community
https://forums.couchbase.com/c/mobile/14[Mobile Forum] |
https://blog.couchbase.com/[Blog] |
https://docs.couchbase.com/tutorials/[Tutorials]


.



++++
</div>
++++

:page-toclevels: 2

